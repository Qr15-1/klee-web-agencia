---
import { Icon } from 'astro-icon/components';

// 1. Recibimos la función 't'
const { t } = Astro.props;

// 2. Actualizamos el array para que use claves de traducción
const portfolioItems = [
    { image: '/imagenes/nr1.jpg', textKey: 'serviceCarousel.card1Title' },
    { image: '/imagenes/nr2.jpg', textKey: 'serviceCarousel.card2Title' },
    { image: '/imagenes/nr3.jpg', textKey: 'serviceCarousel.card3Title' },
];
---

<div class="container mx-auto px-6 mt-16">
    <section class="
        portfolio-section relative
        rounded-3xl bg-black/20 backdrop-blur-sm border border-white/10
        py-16 overflow-hidden
    ">
        <div class="absolute inset-0 z-0 bg-gradient-to-br from-red-800/80 via-indigo-950 to-blue-950 rounded-3xl"></div>

        <div class="relative z-10 px-6 md:px-12 pt-8">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">

                <!-- COLUMNA IZQUIERDA CON TEXTOS TRADUCIDOS -->
                <div class="text-white lg:pl-16">
                    <h2 class="font-display text-7xl md:text-8xl tracking-wide leading-none">
                        {t('serviceCarousel.title1')} <br>
                        <span class="text-klee-yellow">{t('serviceCarousel.title2')}</span>
                    </h2>
                    <p class="font-sans text-gray-500 my-6 max-w-md leading-relaxed">
                        {t('serviceCarousel.description')}
                    </p>
                    <a href="#" class="inline-flex items-center gap-3 bg-klee-yellow text-black font-bold py-4 px-8 rounded-full text-sm tracking-wider hover:bg-opacity-80 transition-colors">
                        {t('serviceCarousel.button')}
                        <Icon name="mdi:arrow-right-circle-outline" class="w-6 h-6" />
                    </a>
                </div>

                <!-- CARRUSEL CON TÍTULOS DE TARJETAS TRADUCIDOS -->
                <div class="w-full">
                    <div class="portfolio-carousel-container relative">
                        <div class="swiper portfolio-swiper overflow-visible">
                            <div class="swiper-wrapper items-center">
                                {portfolioItems.map(item => (
                                    <div class="swiper-slide">
                                        <div class="card-content bg-white rounded-2xl p-4 text-center shadow-2xl">
                                            <img src={item.image} alt={t(item.textKey)} class="rounded-lg mb-4 w-full" />
                                            <h3 class="font-sans font-bold text-black text-lg uppercase leading-tight">{t(item.textKey)}</h3>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                        <div class="portfolio-prev-btn">
                            <Icon name="mdi:chevron-double-left" class="w-8 h-8 text-white"/>
                        </div>
                        <div class="portfolio-next-btn">
                            <Icon name="mdi:chevron-double-right" class="w-8 h-8 text-white"/>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<!-- Script y Estilos se mantienen igual -->
<script>
    import Swiper from 'swiper';
    import { Navigation, EffectCoverflow } from 'swiper/modules';
    import 'swiper/css';
    import 'swiper/css/navigation';
    import 'swiper/css/effect-coverflow';

    const swiper = new Swiper('.portfolio-swiper', {
        modules: [Navigation, EffectCoverflow],
        effect: 'coverflow',
        grabCursor: true,
        centeredSlides: true,
        slidesPerView: 3,
        loop: false,
        initialSlide: 1,
        coverflowEffect: {
            rotate: 0,
            stretch: -20,
            depth: 100,
            modifier: 1,
            slideShadows: false
        },
        navigation: {
            nextEl: '.portfolio-next-btn',
            prevEl: '.portfolio-prev-btn'
        },
    });

    import { gsap } from 'gsap';
    import { ScrollTrigger } from "gsap/ScrollTrigger";
    gsap.registerPlugin(ScrollTrigger);

    gsap.to(".portfolio-section .relative.z-10", {
        y: -100,
        ease: "none",
        scrollTrigger: {
            trigger: ".portfolio-section",
            start: "top bottom",
            end: "bottom top",
            scrub: true,
        }
    });
</script>

<style>
    .portfolio-swiper { width: 100%; padding: 50px 0; }
    .swiper-slide {
        width: 300px;
        height: 400px;
        transition: transform 0.4s ease, opacity 0.4s ease;
        opacity: 0.4;
        transform: scale(0.8);
    }
    .swiper-slide .card-content {
        height: 100%;
        display: flex;
        flex-direction: column;
    }
    .swiper-slide .card-content img {
        flex-grow: 1;
        object-fit: cover;
    }
    .swiper-slide-active {
        opacity: 1;
        transform: scale(1);
        z-index: 1;
    }
    .portfolio-prev-btn, .portfolio-next-btn {
        @apply bg-klee-yellow rounded-full w-14 h-14 flex items-center justify-center
               absolute top-1/2 -translate-y-1/2 z-20 cursor-pointer
               hover:scale-110 transition-transform shadow-lg;
    }
    .portfolio-prev-btn { left: 20%; transform: translate(-50%, -50%); }
    .portfolio-next-btn { right: 20%; transform: translate(50%, -50%); }
</style>